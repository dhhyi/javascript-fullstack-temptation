const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/slidev/shiki-Dg9R95sn.js","assets/monaco/bundled-types-CDwOfZAi.js","assets/modules/file-saver-BzOOqXCn.js","assets/modules/vue-BYJtssLi.js","assets/monaco/bundled-types-DvHyS8RE.css","assets/modules/shiki-RUd7EipU.js","assets/modules/shiki-CozCpemh.css"])))=>i.map(i=>d[i]);
import{r as ref,d as defineComponent,G as watchEffect,f as createElementBlock,o as openBlock,ae as useVModel,z as computed,U as shallowRef,P as onMounted,aR as watchSyncEffect,S as onUnmounted,E as watch,ah as withDirectives,i as createCommentVNode,am as vShow,g as createBaseVNode,t as toDisplayString,X as unref,F as Fragment,aj as renderList,b as createBlock,n as normalizeClass,H as toValue,k as normalizeStyle,e as createVNode,w as withCtx}from"../modules/vue-BYJtssLi.js";import{n as defineCodeRunnersSetup,o as createSingletonPromise,_ as __vitePreload,l as debounce,k as toArray}from"../monaco/bundled-types-CDwOfZAi.js";import{a as useNav,a9 as makeId}from"../index-CubVFy7z.js";import{u as useSlideContext}from"./context-CENLyI0p.js";import{_ as _sfc_main$2}from"./IconButton.vue_vue_type_script_setup_true_lang-A2uNyObF.js";import"../modules/file-saver-BzOOqXCn.js";import"../modules/shiki-RUd7EipU.js";const deps={},__n0=defineCodeRunnersSetup(()=>({async jseval(code,ctx){try{const result=code.split(`
`).map(o=>o.trim()).map(line=>eval(line));return{text:result.join(`
`),html:result.join("<br>")}}catch(o){return{text:`Error: ${o.message}`,html:`<span style="color: red;">${o.name}: ${o.message}</span>`}}}})),setups=[__n0],setupCodeRunners=createSingletonPromise(async()=>{const o={javascript:runTypeScript,js:runTypeScript,typescript:runTypeScript,ts:runTypeScript},{getHighlighter:t}=await __vitePreload(async()=>{const{getHighlighter:s}=await import("./shiki-Dg9R95sn.js");return{getHighlighter:s}},__vite__mapDeps([0,1,2,3,4,5,6])),r=await t(),m=async(s,u,a)=>{try{const c=o[u];if(!c)throw new Error(`Runner for language "${u}" not found`);return await c(s,{options:a,highlight:r,run:async(e,n)=>await m(e,n,a)})}catch(c){return console.error(c),{error:`${c}`}}};for(const s of setups){const u=await s(o);Object.assign(o,u)}return{highlight:r,run:m}});function runJavaScript(o){const t=ref([]),r=e=>t.value.push({error:String(e)}),m=(...e)=>t.value.push(e.map(u)),s=Object.assign({},console);s.info=s.log=s.debug=s.warn=s.error=m,s.clear=()=>t.value.length=0;try{const e=`return async (console, __slidev_import, __slidev_on_error) => {
      try {
        ${c(o)}
      } catch (e) {
        __slidev_on_error(e)
      }
    }`;new Function(e)()(s,n=>{const l=deps[n];if(!l)throw new Error(`Module not found: ${n}.
Available modules: ${Object.keys(deps).join(", ")}. Please refer to https://sli.dev/custom/config-code-runners#additional-runner-dependencies`);return l},r)}catch(e){r(e)}function u(e){return typeof e=="string"?{text:e}:{text:a(e),highlightLang:"javascript"}}function a(e){var l;let n="";if(e instanceof Error)n=`Error: ${JSON.stringify(e.message)}`;else if(e==null||typeof e=="symbol")n=String(e);else if(Array.isArray(e))n=`[${e.map(a).join(", ")}]`;else if(e instanceof Set){const i=[...e];n=`Set (${e.size}) {${i.map(a).join(", ")}}`}else if(e instanceof Map){const i=[...e.entries()];n=`Map (${e.size}) {${i.map(([d,p])=>`${a(d)} => ${a(p)}`).join(", ")}}`}else if(e instanceof RegExp)n=e.toString();else if(typeof e=="string")n=JSON.stringify(e);else if(typeof e=="object"){const i=((l=e.constructor)==null?void 0:l.name)??"",d=i&&i==="Object"?"":i;n=(d?`${d}: `:"")+JSON.stringify(e,(v,_)=>_===void 0?"__undefined__":_,2).replace(/"__undefined__"/g,"undefined"),n=String(n)}else n=String(e);return n}function c(e){return e=e.replace('import "reflect-metadata"',"").replace('require("reflect-metadata")',""),e=e.replace("export {};",""),e}return t}let tsModule;async function runTypeScript(o){tsModule??(tsModule=await __vitePreload(()=>import("../monaco/bundled-types-CDwOfZAi.js").then(r=>r.t),__vite__mapDeps([1,2,3,4]))),o=tsModule.transpileModule(o,{compilerOptions:{module:tsModule.ModuleKind.ESNext,target:tsModule.ScriptTarget.ES2022},transformers:{after:[transformImports]}}).outputText;const t=/import\s*\((.+)\)/g;return o=o.replace(t,(r,m)=>`__slidev_import(${m})`),runJavaScript(o)}function transformImports(o){const{factory:t}=o,{isImportDeclaration:r,isNamedImports:m,NodeFlags:s}=tsModule;return u=>{var c,e;const a=[...u.statements];for(let n=0;n<a.length;n++){const l=a[n];if(!r(l))continue;let i;const d=(c=l.importClause)==null?void 0:c.namedBindings,p=[];if((e=l.importClause)!=null&&e.name&&p.push(t.createBindingElement(void 0,t.createIdentifier("default"),l.importClause.name)),d)if(m(d)){for(const _ of d.elements)p.push(t.createBindingElement(void 0,_.propertyName,_.name));i=t.createObjectBindingPattern(p)}else i=t.createIdentifier(d.name.text);else i=t.createObjectBindingPattern(p);const v=t.createVariableStatement(void 0,t.createVariableDeclarationList([t.createVariableDeclaration(i,void 0,void 0,t.createAwaitExpression(t.createCallExpression(t.createIdentifier("import"),void 0,[l.moduleSpecifier])))],s.Const));a[n]=v}return t.updateSourceFile(u,a)}}const _sfc_main$1=defineComponent({__name:"DomElement",props:{element:{}},setup(o){const t=o,r=ref();return watchEffect(()=>{r.value&&r.value.appendChild(t.element)}),(m,s)=>(openBlock(),createElementBlock("div",{ref_key:"container",ref:r},null,512))}}),_hoisted_1={key:0,class:"text-sm text-center opacity-50"},_hoisted_2={key:1,class:"text-sm text-center opacity-50"},_hoisted_3={key:2,class:"text-sm text-center opacity-50"},_hoisted_4=["innerHTML"],_hoisted_5={key:1,class:"text-red-500"},_hoisted_6={key:3,class:"output-line"},_hoisted_7=["innerHTML"],_hoisted_8={key:2,class:"separator"},_hoisted_9={key:0,class:"absolute right-1 top-1 max-h-full flex gap-1"},_sfc_main=defineComponent({__name:"CodeRunner",props:{modelValue:{},lang:{},autorun:{type:[Boolean,String]},height:{},showOutputAt:{type:[null,Boolean,String,Number,Array]},highlightOutput:{type:Boolean},runnerOptions:{}},emits:["update:modelValue"],setup(o,{emit:t}){const r=o,m=t,{isPrintMode:s}=useNav(),u=useVModel(r,"modelValue",m),{$renderContext:a,$clicksContext:c}=useSlideContext(),e=computed(()=>!["slide","presenter"].includes(a.value)),n=s.value?"once":r.autorun,l=ref(n),i=shallowRef(),d=ref(0),p=ref(),v=ref(r.showOutputAt);if(r.showOutputAt){const g=makeId();onMounted(()=>{const h=c.calculate(r.showOutputAt);h?(c.register(g,h),watchSyncEffect(()=>{v.value=!h.isActive.value})):v.value=!1}),onUnmounted(()=>c.unregister(g))}const _=debounce(200,async()=>{if(e.value)return;const{highlight:g,run:h}=await setupCodeRunners();p.value=g;const f=setTimeout(()=>{l.value=!0},500);i.value=await h(u.value,r.lang,r.runnerOptions??{}),d.value+=1,l.value=!1,clearTimeout(f)});return n==="once"?_():n&&watch(u,_,{immediate:!0}),(g,h)=>(openBlock(),createElementBlock(Fragment,null,[withDirectives(createBaseVNode("div",{class:"relative flex flex-col rounded-b border-t border-main",style:normalizeStyle({height:r.height}),"data-waitfor":".slidev-runner-output"},[e.value?(openBlock(),createElementBlock("div",_hoisted_1,' Code is disabled in the "'+toDisplayString(unref(a))+'" mode ',1)):l.value?(openBlock(),createElementBlock("div",_hoisted_2," Running... ")):i.value?(openBlock(),createElementBlock("div",{key:`run-${d.value}`,class:"slidev-runner-output"},[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(toArray)(toValue(i.value)),(f,B)=>(openBlock(),createElementBlock(Fragment,{key:B},["html"in f?(openBlock(),createElementBlock("div",{key:0,innerHTML:f.html},null,8,_hoisted_4)):"error"in f?(openBlock(),createElementBlock("div",_hoisted_5,toDisplayString(f.error),1)):"element"in f?(openBlock(),createBlock(_sfc_main$1,{key:2,element:f.element},null,8,["element"])):(openBlock(),createElementBlock("div",_hoisted_6,[(openBlock(!0),createElementBlock(Fragment,null,renderList(unref(toArray)(f),(y,k)=>(openBlock(),createElementBlock(Fragment,{key:k},[y.highlightLang&&p.value?(openBlock(),createElementBlock("span",{key:0,class:"highlighted",innerHTML:p.value(y.text,y.highlightLang)},null,8,_hoisted_7)):(openBlock(),createElementBlock("span",{key:1,class:normalizeClass(y.class)},toDisplayString(y.text),3)),k<unref(toArray)(f).length-1?(openBlock(),createElementBlock("span",_hoisted_8,",")):createCommentVNode("v-if",!0)],64))),128))]))],64))),128))])):(openBlock(),createElementBlock("div",_hoisted_3," Click the play button to run the code "))],4),[[vShow,!v.value]]),unref(u).trim()?(openBlock(),createElementBlock("div",_hoisted_9,[createVNode(_sfc_main$2,{class:"w-8 h-8 max-h-full flex justify-center items-center",title:"Run code",onClick:unref(_)},{default:withCtx(()=>h[0]||(h[0]=[createBaseVNode("div",{class:"i-carbon:play"},null,-1)])),_:1,__:[0]},8,["onClick"])])):createCommentVNode("v-if",!0)],64))}});export{_sfc_main as default};
